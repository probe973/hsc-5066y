<div class="question-container" id="question-{{ include.id }}">
    <h3>Question: {{ include.title | default: "Numerical Input" }}</h3>
    <div class="question-content">
        {{ include.question_text | markdownify }}
    </div>

    <input type="number" id="input-{{ include.id }}" placeholder="Enter your answer">
    <button class="btn" onclick="checkNumericalAnswer('{{ include.id }}', '{{ include.correct_answer }}', '{{ include.tolerance | default: 0 }}')">Check Answer</button>

    <div id="feedback-{{ include.id }}" class="feedback"></div>

    {% if include.show_solution %}
        <button class="btn btn-primary" onclick="toggleSolution('solution-{{ include.id }}')">Show Solution</button>
        <div id="solution-{{ include.id }}" class="solution-content">
            <h4>Solution:</h4>
            {{ include.solution_text | markdownify }}
        </div>
    {% endif %}
</div>

<script>
    // This script will be consolidated into assets/js/scripts.js later
    // For now, it's here for immediate context.
    function checkNumericalAnswer(id, correctAnswer, toleranceStr) {
        const inputElement = document.getElementById(`input-${id}`);
        const feedbackElement = document.getElementById(`feedback-${id}`);
        const userAnswer = parseFloat(inputElement.value);
        const correct = parseFloat(correctAnswer);
        const tolerance = parseFloat(toleranceStr);

        feedbackElement.classList.remove('feedback-correct', 'feedback-incorrect');
        feedbackElement.textContent = '';

        if (isNaN(userAnswer)) {
            feedbackElement.textContent = 'Please enter a number.';
            feedbackElement.classList.add('feedback-incorrect');
            return;
        }

        if (Math.abs(userAnswer - correct) <= tolerance) {
            feedbackElement.textContent = 'Correct!';
            feedbackElement.classList.add('feedback-correct');
        } else {
            feedbackElement.textContent = 'Incorrect. Try again!';
            feedbackElement.classList.add('feedback-incorrect');
        }
    }

    // `toggleSolution` from above is also needed here if show_solution is true
</script>
